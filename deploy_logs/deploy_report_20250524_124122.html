<h1 id="éƒ¨ç½²æŠ¥å‘Š-20250524_124122">éƒ¨ç½²æŠ¥å‘Š 20250524_124122</h1>
<p><strong>çŠ¶æ€ï¼š</strong> <strong>å»¶è¿Ÿï¼š</strong> 0ms
<strong>å…³é”®è¯æ£€æµ‹ï¼š</strong> EnlightenVision <strong>ç½‘å€ï¼š</strong> <a
href="https://enlightenvision.net">https://enlightenvision.net</a>
<strong>æˆåŠŸç‡ï¼š</strong> 100% (3/3)</p>
<h2 id="æœ¬æ¬¡å˜æ›´">æœ¬æ¬¡å˜æ›´</h2>
<pre><code>On branch main
Your branch is up to date with &#39;origin/main&#39;.

Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
    modified:   deploy.sh

Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
    deploy_git_changes_20250524_124122.txt
    deploy_log_20250524_121609.txt

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
diff --git a/deploy.sh b/deploy.sh
index 812b4ad..adbdeda 100755
--- a/deploy.sh
+++ b/deploy.sh
@@ -1,148 +1,154 @@
 #!/bin/bash
 
-# ===================== é…ç½®éƒ¨åˆ† =====================
-PAGE_URL=&quot;https://enlightenvision.net&quot;                 # Cloudflare Pages å®é™…ç½‘å€
-KEYWORD=&quot;EnlightenVision&quot;                             # éƒ¨ç½²é¡µé¢åº”åŒ…å«çš„å…³é”®è¯
-CHAT_ID=&quot;413142477&quot;                                  # Telegram Chat ID
-BOT_TOKEN=&quot;8106822194:AAF-xkNrMk6iCkVuBXz3FZRJpidgu-MoqPI&quot;  # Telegram æœºå™¨äºº Token
-OPEN_BROWSER=true                                      # æ˜¯å¦è‡ªåŠ¨æ‰“å¼€ Safari é¢„è§ˆ
-SEND_SCREENSHOT=true                                   # æ˜¯å¦å‘é€é¡µé¢æˆªå›¾
-MAX_RETRY=3                                            # æ„å»ºå¤±è´¥æœ€å¤§é‡è¯•æ¬¡æ•°
-
-# ===================== åˆå§‹åŒ–å˜é‡ =====================
+############################################
+#         Cloudflare + Hexo ä¸€é”®éƒ¨ç½²è„šæœ¬
+#   1. æ£€æŸ¥ Git å˜æ›´ï¼Œæ— å˜æ›´è‡ªåŠ¨è·³è¿‡
+#   2. Hexo æ„å»ºã€Git æäº¤ã€æ¨é€ GitHub
+#   3. æ£€æµ‹é¡µé¢å»¶è¿Ÿä¸å…³é”®è¯åˆ¤æ–­éƒ¨ç½²
+#   4. è‡ªåŠ¨ä¿å­˜æ—¥å¿—ã€ç”Ÿæˆç»Ÿè®¡å›¾
+#   5. è‡ªåŠ¨å‘é€ Telegram æ¶ˆæ¯ï¼ˆå«å›¾è¡¨/æˆªå›¾ï¼‰
+#   6. æ„å»ºå¤±è´¥è‡ªåŠ¨é‡è¯•
+#   7. æ‰“å¼€ Safari æµè§ˆå™¨é¢„è§ˆ
+############################################
+
+# ========== é…ç½®åŒºåŸŸ ==========
+PAGE_URL=&quot;https://enlightenvision.net&quot;   # ä½ çš„ Cloudflare Pages ç½‘å€
+KEYWORD=&quot;EnlightenVision&quot;                # éƒ¨ç½²é¡µé¢æ£€æµ‹å…³é”®è¯
+CHAT_ID=&quot;413142477&quot;                      # Telegram Chat ID
+BOT_TOKEN=&quot;8106822194:AAF-xkNrMk6iCkVuBXz3FZRJpidgu-MoqPI&quot;  # Telegram Bot Token
+OPEN_BROWSER=true                        # æ˜¯å¦è‡ªåŠ¨æ‰“å¼€ Safari
+SEND_SCREENSHOT=true                     # æ˜¯å¦å‘é€é¡µé¢æˆªå›¾
+RETRY=2                                  # å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°
+
+# ========== åˆå§‹åŒ–å˜é‡ ==========
 DATE_TAG=$(date &quot;+%Y%m%d_%H%M%S&quot;)
-DEPLOY_DIR=&quot;/Users/zshe/evo&quot;                            # é¡¹ç›®è·¯å¾„ï¼ˆå›ºå®šä¸ºä½ å½“å‰è·¯å¾„ï¼‰
-LOG_FILE=&quot;$DEPLOY_DIR/deploy_log_${DATE_TAG}.txt&quot;
-HISTORY_LOG=&quot;$DEPLOY_DIR/deploy_history.log&quot;
-
-cd &quot;$DEPLOY_DIR&quot; || exit 1
+LOG_FILE=&quot;deploy_log_${DATE_TAG}.txt&quot;
+DEPLOY_DIR=&quot;$(pwd)&quot;
+GIT_CHANGE_FILE=&quot;deploy_git_changes_${DATE_TAG}.txt&quot;
+PNG_CHART=&quot;deploy_chart_${DATE_TAG}.png&quot;
 
-# ===================== æ£€æŸ¥æ˜¯å¦æœ‰ Git æ”¹åŠ¨ =====================
+# ========== æ£€æŸ¥æ˜¯å¦æœ‰å˜æ›´ ==========
 echo &quot;æ£€æŸ¥ Git çŠ¶æ€...&quot;
-git diff --quiet &amp;&amp; git diff --cached --quiet
-if [ $? -eq 0 ]; then
-  echo &quot;[$DATE_TAG] æ— æ–‡ä»¶å˜åŠ¨ï¼Œåœæ­¢éƒ¨ç½²ã€‚&quot; | tee -a &quot;$HISTORY_LOG&quot;
+if git diff --quiet &amp;&amp; git diff --cached --quiet; then
+  echo &quot;[ç•¥è¿‡] æ²¡æœ‰æ–‡ä»¶å˜æ›´ï¼Œåœæ­¢éƒ¨ç½²ã€‚&quot;
+  echo &quot;[$DATE_TAG] No changes detected. Skipped.&quot; &gt;&gt; deploy_history.log
   exit 0
 fi
 
-# ===================== Hexo æ„å»ºï¼ˆè‡ªåŠ¨é‡è¯•ï¼‰ =====================
-RETRY=0
-while [ $RETRY -lt $MAX_RETRY ]; do
-  echo &quot;Hexo æ„å»ºä¸­... ç¬¬ $((RETRY+1)) æ¬¡å°è¯•&quot;
-  hexo clean &amp;&amp; hexo g &amp;&amp; break
-  RETRY=$((RETRY+1))
-  echo &quot;æ„å»ºå¤±è´¥ï¼Œé‡è¯•ä¸­ ($RETRY/$MAX_RETRY)...&quot;
-  sleep 2
-
+# ========== æ”¶é›†æœ¬æ¬¡ Git å˜æ›´ ==========
+git status &gt; &quot;$GIT_CHANGE_FILE&quot;
+git diff &gt;&gt; &quot;$GIT_CHANGE_FILE&quot;
+git diff --cached &gt;&gt; &quot;$GIT_CHANGE_FILE&quot;
+
+# ========== éƒ¨ç½²æµç¨‹(å«å¤±è´¥é‡è¯•) ==========
+TRY=0
+SUCCESS=false
+while [ $TRY -le $RETRY ]; do
+  TRY=$((TRY+1))
+  echo &quot;ç¬¬ $TRY æ¬¡å°è¯• Hexo æ„å»º...&quot;
+  hexo clean &amp;&amp; hexo g
+  BUILD_SUCCESS=$?
+  if [ $BUILD_SUCCESS -eq 0 ]; then
+    # æ„å»ºæˆåŠŸ
+    git add .
+    git commit -m &quot;Auto deploy at $DATE_TAG&quot;
+    git push origin main
+    # æ£€æŸ¥é¡µé¢å»¶è¿Ÿä¸å…³é”®è¯
+    sleep 4  # ä¿è¯ Cloudflare ç«¯æœ‰æ—¶é—´åŒæ­¥ï¼ˆå¯è°ƒï¼‰
+    START_TIME=$(date +%s%3N)
+    HTML=$(curl -s -m 15 &quot;$PAGE_URL&quot;)
+    END_TIME=$(date +%s%3N)
+    DELAY_MS=$((END_TIME - START_TIME))
+    if [[ &quot;$HTML&quot; == *&quot;$KEYWORD&quot;* ]]; then
+      STATUS=&quot;âœ… éƒ¨ç½²æˆåŠŸ&quot;
+      SUCCESS=true
+      break
+    else
+      STATUS=&quot;âŒ éƒ¨ç½²å¤±è´¥ï¼šæ‰¾ä¸åˆ°å…³é”®è¯&quot;
+    fi
+  else
+    STATUS=&quot;âŒ Hexo æ„å»ºå¤±è´¥&quot;
+  fi
+  # æ„å»ºå¤±è´¥è‡ªåŠ¨é‡è¯•
+  if [ $TRY -le $RETRY ]; then
+    echo &quot;éƒ¨ç½²å¤±è´¥ï¼Œ$((10*TRY))ç§’åé‡è¯•...&quot;
+    sleep $((10 * TRY))
+  fi
 done
 
-if [ $RETRY -eq $MAX_RETRY ]; then
-  echo &quot;âŒ æ„å»ºå¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚&quot; | tee &quot;$LOG_FILE&quot;
-  curl -s -X POST &quot;https://api.telegram.org/bot${BOT_TOKEN}/sendMessage&quot; \
-    -d chat_id=&quot;${CHAT_ID}&quot; \
-    -d text=&quot;âŒ Hexo æ„å»ºå¤±è´¥ï¼Œæœ€å¤§é‡è¯•å·²è¾¾ï¼Œè¯·æ‰‹åŠ¨æ£€æŸ¥ã€‚&quot;
-  exit 1
+# ========== æ—¥å¿—è®°å½•ä¸ç»Ÿè®¡ ==========
+echo &quot;[$DATE_TAG] $STATUS å»¶è¿Ÿ ${DELAY_MS:-0}ms&quot; &gt;&gt; deploy_history.log
+SUCCESS_COUNT=$(grep -c &quot;âœ… éƒ¨ç½²æˆåŠŸ&quot; deploy_history.log)
+FAIL_COUNT=$(grep -c &quot;âŒ&quot; deploy_history.log)
+TOTAL_COUNT=$((SUCCESS_COUNT + FAIL_COUNT))
+SUCCESS_RATE=0
+if [ $TOTAL_COUNT -ne 0 ]; then
+  SUCCESS_RATE=$((SUCCESS_COUNT * 100 / TOTAL_COUNT))
 fi
 
-# ===================== Git æäº¤ä¸æ¨é€ =====================
-CHANGES=$(git status --short)
-git add .
-git commit -m &quot;Auto deploy at $DATE_TAG&quot;
-git push origin main
-
-# ===================== æµ‹è¯•éƒ¨ç½²åœ°å€å»¶è¿Ÿä¸å†…å®¹ =====================
-START_TIME=$(date +%s%3N)
-HTML=$(curl -s -m 20 &quot;$PAGE_URL&quot;)
-END_TIME=$(date +%s%3N)
-DELAY_MS=$((END_TIME - START_TIME))
-
-if [[ &quot;$HTML&quot; == *&quot;$KEYWORD&quot;* ]]; then
-  STATUS=&quot;âœ… éƒ¨ç½²æˆåŠŸ&quot;
-  COLOR=&quot;green&quot;
-else
-  STATUS=&quot;âŒ éƒ¨ç½²å¤±è´¥ï¼šå…³é”®è¯æœªå‘ç°&quot;
-  COLOR=&quot;red&quot;
-fi
+# ========== ç”Ÿæˆæœ¬åœ° HTML/Markdown ç®€æ˜“æŠ¥å‘Š ==========
+REPORT_MD=&quot;deploy_report_${DATE_TAG}.md&quot;
+REPORT_HTML=&quot;deploy_report_${DATE_TAG}.html&quot;
+echo -e &quot;# éƒ¨ç½²æŠ¥å‘Š ${DATE_TAG}

**çŠ¶æ€ï¼š** $STATUS
**å»¶è¿Ÿï¼š** ${DELAY_MS:-0}ms
**å…³é”®è¯æ£€æµ‹ï¼š** $KEYWORD
**ç½‘å€ï¼š** [$PAGE_URL]($PAGE_URL)
**æˆåŠŸç‡ï¼š** $SUCCESS_RATE% ($SUCCESS_COUNT/$TOTAL_COUNT)

## æœ¬æ¬¡å˜æ›´
\`\`\`
$(cat $GIT_CHANGE_FILE)
\`\`\`&quot; &gt; &quot;$REPORT_MD&quot;
+pandoc &quot;$REPORT_MD&quot; -o &quot;$REPORT_HTML&quot; --from markdown --to html
+
+# ========== ç”Ÿæˆç»Ÿè®¡å›¾è¡¨ï¼ˆå»¶è¿Ÿ/æˆåŠŸç‡ï¼‰==========
+python3 &lt;&lt; EOF
+import matplotlib.pyplot as plt, re
+log_path = &quot;deploy_history.log&quot;
+delays = []
+statuses = []
+with open(log_path) as f:
+    for line in f:
+        m = re.search(r&#39;(\d+)ms&#39;, line)
+        if m: delays.append(int(m.group(1)))
+        statuses.append(&quot;æˆåŠŸ&quot; if &quot;âœ…&quot; in line else &quot;å¤±è´¥&quot;)
+fig, ax = plt.subplots()
+ax.plot(delays, marker=&#39;o&#39;, label=&#39;å»¶è¿Ÿ(ms)&#39;)
+ax.set_xlabel(&quot;éƒ¨ç½²æ¬¡æ•°&quot;)
+ax.set_ylabel(&quot;å»¶è¿Ÿ(ms)&quot;)
+ax2 = ax.twinx()
+ax2.plot([i for i,s in enumerate(statuses) if s==&quot;æˆåŠŸ&quot;], [delays[i] for i,s in enumerate(statuses) if s==&quot;æˆåŠŸ&quot;], &#39;g.&#39;, label=&#39;æˆåŠŸ&#39;, alpha=0.5)
+ax2.plot([i for i,s in enumerate(statuses) if s==&quot;å¤±è´¥&quot;], [delays[i] for i,s in enumerate(statuses) if s==&quot;å¤±è´¥&quot;], &#39;r.&#39;, label=&#39;å¤±è´¥&#39;, alpha=0.5)
+plt.title(&quot;éƒ¨ç½²å»¶è¿Ÿ &amp; æˆåŠŸåˆ†å¸ƒ&quot;)
+plt.savefig(&quot;$PNG_CHART&quot;)
+EOF
 
-# ===================== è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ =====================
+# ========== è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ ==========
 if $OPEN_BROWSER; then
-  echo &quot;æ‰“å¼€ Safari é¢„è§ˆ...&quot;
   open -a Safari &quot;$PAGE_URL&quot;
 fi
 
-# ===================== ä¿å­˜å†å²æ—¥å¿— =====================
-echo &quot;[$DATE_TAG] $STATUS å»¶è¿Ÿ ${DELAY_MS}ms&quot; | tee &quot;$LOG_FILE&quot; &gt;&gt; &quot;$HISTORY_LOG&quot;
-SUCCESS_COUNT=$(grep -c &quot;âœ… éƒ¨ç½²æˆåŠŸ&quot; &quot;$HISTORY_LOG&quot;)
-FAIL_COUNT=$(grep -c &quot;âŒ&quot; &quot;$HISTORY_LOG&quot;)
-TOTAL_COUNT=$((SUCCESS_COUNT + FAIL_COUNT))
-if [ $TOTAL_COUNT -gt 0 ]; then
-  SUCCESS_RATE=$((SUCCESS_COUNT * 100 / TOTAL_COUNT))
-else
-  SUCCESS_RATE=0
-fi
-
-# ===================== ç”Ÿæˆéƒ¨ç½²æŠ¥å‘Š HTML =====================
+# ========== Telegram HTML æŠ¥å‘Š ==========
 HTML_REPORT=&quot;&lt;b&gt;${STATUS}&lt;/b&gt;&lt;br&gt;
 å…³é”®è¯: &lt;code&gt;${KEYWORD}&lt;/code&gt;&lt;br&gt;
-å»¶è¿Ÿ: &lt;code&gt;${DELAY_MS} ms&lt;/code&gt;&lt;br&gt;
+å»¶è¿Ÿ: &lt;code&gt;${DELAY_MS:-0} ms&lt;/code&gt;&lt;br&gt;
 éƒ¨ç½²æ—¶é—´: &lt;code&gt;${DATE_TAG}&lt;/code&gt;&lt;br&gt;
 æˆåŠŸç‡: &lt;b&gt;${SUCCESS_RATE}%&lt;/b&gt; (${SUCCESS_COUNT}/${TOTAL_COUNT})&lt;br&gt;
-ğŸ”— &lt;a href=&#39;${PAGE_URL}&#39;&gt;ç‚¹æˆ‘é¢„è§ˆ&lt;/a&gt;&lt;br&gt;
-ğŸ“„ &lt;pre&gt;${CHANGES}&lt;/pre&gt;&quot;
+ğŸ”— &lt;a href=&#39;${PAGE_URL}&#39;&gt;é¢„è§ˆç½‘ç«™&lt;/a&gt;&lt;br&gt;
+&lt;pre&gt;å˜æ›´:
$(tail -20 $GIT_CHANGE_FILE | sed &#39;s/&lt;/\&amp;lt;/g; s/&gt;/\&amp;gt;/g;&#39;)&lt;/pre&gt;&quot;
 
-# ===================== æ¨é€ Telegram æŠ¥å‘Š =====================
 curl -s -X POST &quot;https://api.telegram.org/bot${BOT_TOKEN}/sendMessage&quot; \
-  -d chat_id=&quot;${CHAT_ID}&quot; \
+  -d chat_id=&quot;$CHAT_ID&quot; \
   -d text=&quot;$HTML_REPORT&quot; \
   -d parse_mode=&quot;HTML&quot;
 
-# ===================== é¡µé¢æˆªå›¾ï¼ˆå®Œæ•´ï¼‰ =====================
+# ========== Telegram ç»Ÿè®¡å›¾è¡¨ ==========
+curl -s -X POST &quot;https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto&quot; \
+  -F chat_id=&quot;$CHAT_ID&quot; \
+  -F photo=@&quot;$PNG_CHART&quot; \
+  -F caption=&quot;ğŸ“ˆ éƒ¨ç½²å»¶è¿Ÿå’ŒæˆåŠŸç‡ç»Ÿè®¡&quot;
+
+# ========== é¡µé¢æˆªå›¾ï¼ˆSafari é¡µé¢åŠ è½½åŠ¨ç”»å»¶è¿Ÿï¼‰==========
 if $SEND_SCREENSHOT; then
-  echo &quot;å‡†å¤‡æˆªå›¾...&quot;
-  sleep 3
   SCREENSHOT_PATH=&quot;/tmp/page_shot_${DATE_TAG}.png&quot;
-  screencapture -x -R0,0,1280,800 &quot;$SCREENSHOT_PATH&quot;
+  sleep 4  # å»¶è¿Ÿï¼Œç¡®ä¿åŠ¨ç”»ç»“æŸ
+  screencapture -x -R0,0,1280,900 &quot;$SCREENSHOT_PATH&quot;
   curl -s -X POST &quot;https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto&quot; \
-    -F chat_id=&quot;${CHAT_ID}&quot; \
+    -F chat_id=&quot;$CHAT_ID&quot; \
     -F photo=&quot;@${SCREENSHOT_PATH}&quot; \
-    -F caption=&quot;ğŸ“¸ é¡µé¢æˆªå›¾&quot;
+    -F caption=&quot;ğŸ“¸ é¡µé¢æˆªå›¾ (${DATE_TAG})&quot;
 fi
 
-# ===================== ç”ŸæˆæˆåŠŸç‡å›¾è¡¨ï¼ˆå¯é€‰ï¼‰ =====================
-python3 &lt;&lt;EOF
-import matplotlib.pyplot as plt
-import re
-from datetime import datetime
-
-lines = open(&quot;$HISTORY_LOG&quot;).readlines()
-dates, statuses, delays = [], [], []
-for line in lines:
-    m = re.match(r&quot;\[(.*?)\] (.*?) å»¶è¿Ÿ (\d+)ms&quot;, line)
-    if m:
-        dt = datetime.strptime(m[1], &quot;%Y%m%d_%H%M%S&quot;)
-        dates.append(dt)
-        statuses.append(&quot;æˆåŠŸ&quot; if &quot;âœ…&quot; in m[2] else &quot;å¤±è´¥&quot;)
-        delays.append(int(m[3]))
-
-plt.figure(figsize=(10, 4))
-colors = [&quot;green&quot; if s == &quot;æˆåŠŸ&quot; else &quot;red&quot; for s in statuses]
-plt.bar(dates, delays, color=colors)
-plt.xticks(rotation=45)
-plt.title(&quot;éƒ¨ç½²å»¶è¿Ÿè¶‹åŠ¿å›¾&quot;)
-plt.ylabel(&quot;å»¶è¿Ÿ (ms)&quot;)
-plt.tight_layout()
-chart_path = &quot;$DEPLOY_DIR/deploy_chart_${DATE_TAG}.png&quot;
-plt.savefig(chart_path)
-
-# æ¨é€å›¾è¡¨åˆ° Telegram
-import requests
-requests.post(
-    f&quot;https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto&quot;,
-    data={&quot;chat_id&quot;: &quot;$CHAT_ID&quot;},
-    files={&quot;photo&quot;: open(chart_path, &quot;rb&quot;)}
-)
-EOF
-
-# ===================== ç»“æŸ =====================
 echo &quot;éƒ¨ç½²å®Œæˆ âœ…&quot;
 exit 0
\ No newline at end of file</code></pre>
